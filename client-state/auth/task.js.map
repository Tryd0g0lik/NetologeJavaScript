{"version":3,"sources":["task.ts"],"names":[],"mappings":"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","file":"task.js","sourcesContent":["const formElement = <HTMLFormElement>document.getElementById('signin__form');\r\nconst formButton = <HTMLElement>document.getElementById('signin__btn');\r\nconst welcome = <HTMLElement>document.getElementById('welcome');\r\nconst user_id = <HTMLElement>document.getElementById('user_id');\r\nconst formInputField = <HTMLCollection>formElement.getElementsByTagName('input');\r\n\r\nclass User {\r\n  // общие св-ва\r\n  readonly logins!: string;\r\n  readonly passwords!: string;\r\n  constructor(userName: string, userPasswords: string) {\r\n    this.logins = userName;\r\n    this.passwords = userPasswords;\r\n  }\r\n}\r\n\r\nclass UserData extends User {\r\n  formId!: string;\r\n  constructor(logins, passwords) {\r\n    super(logins, passwords)\r\n\r\n  }\r\n\r\n\r\n\r\n  //встановить Login / password в форме\r\n  // Запрос на сервер\r\n  http() {\r\n\r\n    let http;\r\n    try {\r\n      if (window.XMLHttpRequest) {\r\n        http = new XMLHttpRequest();\r\n\r\n      } else if (window.ActiveXObject) {\r\n        http = new ActiveXObject(\"Microsoft.XMLHTTP\")\r\n      }\r\n\r\n      http.open('POST', 'https://students.netoservices.ru/nestjs-backend/auth', true);\r\n      http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n      let login = this.logins;\r\n      let pass = this.passwords;\r\n\r\n      http.addEventListener(\"readystatechange\", (e) => {\r\n\r\n        if (http.readyState === http.DONE) {\r\n          console.log(\"http.status: \", http.status)\r\n          console.log(\"http.statusText: \", http.statusText)\r\n          console.log(\"http.responseText: \", http.responseText)\r\n          if (http.status === 201) {\r\n            user_id.innerHTML = login;\r\n            welcome.classList.add('welcome_active')\r\n          }\r\n        }\r\n      })\r\n\r\n      http.send(`login=${login}&password=${pass}`);\r\n\r\n    } catch (e) {\r\n      let errors!: string;\r\n      errors = <string>`ERROR message: ${e.message}`;\r\n\r\n      formElement.insertAdjacentHTML('beforeend', `<p>${errors}</p>`);\r\n\r\n    }\r\n\r\n  }\r\n}\r\n\r\n\r\nwindow.onload = () => {\r\n  let arrField!: Element[];\r\n\r\n  try {\r\n    if (!!formElement) {\r\n      let pass: string;\r\n      let login: string;\r\n\r\n      arrField = <HTMLElement[]>Array.from(formInputField).filter(item => item ?\r\n        item.hasAttribute('name') &&\r\n        item.getAttribute('name') === 'login' ||\r\n        item.getAttribute('name') === 'password' : false\r\n      );\r\n\r\n      // нажимаем на button\r\n      formButton.addEventListener('click', (e: Event) => {\r\n        e.preventDefault();\r\n\r\n        // проверка кол-ва полей\r\n        if (arrField.length >= 2) {\r\n\r\n          for (let elem of arrField) {\r\n\r\n            // Проверка предназназначения поля\r\n            let el = <HTMLInputElement>elem;\r\n            if (el.name === \"login\" && el.value.length > 3) {\r\n              login = el.value.trim();\r\n\r\n            };\r\n\r\n            if (el.name === \"password\" && el.value.length > 3) {\r\n              pass = el.value.trim();\r\n\r\n\r\n            };\r\n\r\n            // Если все is very a good, тогда запускаем запрос на сервер\r\n\r\n            if (el.value.trim() && el.value.trim()) {\r\n\r\n              let UserAutorisation = new UserData(el.value.trim(), el.value.trim());\r\n              // запрос на сервер\r\n              UserAutorisation.http()\r\n              // Обнуляем поле\r\n              el.value = null\r\n\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n\r\n    }\r\n  } catch (e) {\r\n\r\n    console.log(`ERROR: ${e.message} // ${e.stack}`)\r\n\r\n  }\r\n\r\n\r\n}//В момент, когда пользователь нажимает на кнопку #signin__btn, необходимо направить AJAX-запрос\r\n\r\nfunction formAuthoris() {\r\n  let elem = <HTMLElement>formElement.closest(\".signin\");\r\n  elem.classList.toggle('signin_active');\r\n  return\r\n}\r\n\r\n"]}